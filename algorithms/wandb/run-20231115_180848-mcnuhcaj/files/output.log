Initial belief is  {'metatask_1': 0.25, 'metatask_2': 0.25, 'metatask_3': 0.25, 'metatask_4': 0.25}
初始策略:  deliver_soup
Computing MediumLevelActionManager
Computing MediumLevelActionManager
/home/wanghm/anaconda3/envs/overcooked_ai/lib/python3.7/site-packages/gym/spaces/box.py:74: UserWarning: [33mWARN: Box bound precision lowered by casting to float32
  "Box bound precision lowered by casting to {}".format(self.dtype)
人类改变至策略:  place_onion_in_pot
人类改变至策略:  random
/alpha/overcooked_rl/script_agent/script_agent.py:175: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  action = np.random.choice(Action.ALL_ACTIONS)
人类改变至策略:  random
人类改变至策略:  random
人类改变至策略:  deliver_soup
人类改变至策略:  random
Ep 1 rewards: 120
Computing MediumLevelActionManager
人类改变至策略:  random
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_and_deliver_soup
Ep 2 rewards: 280
Computing MediumLevelActionManager
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  deliver_soup
人类改变至策略:  random
Ep 3 rewards: 280
Computing MediumLevelActionManager
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
Ep 4 rewards: 220
Computing MediumLevelActionManager
人类改变至策略:  random
人类改变至策略:  deliver_soup
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  deliver_soup
Ep 5 rewards: 240
Computing MediumLevelActionManager
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
人类改变至策略:  random
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
Ep 6 rewards: 260
Computing MediumLevelActionManager
人类改变至策略:  deliver_soup
人类改变至策略:  random
人类改变至策略:  deliver_soup
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
Ep 7 rewards: 220
Computing MediumLevelActionManager
人类改变至策略:  place_onion_in_pot
人类改变至策略:  random
人类改变至策略:  random
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_in_pot
Ep 8 rewards: 260
Computing MediumLevelActionManager
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_and_deliver_soup
Ep 9 rewards: 200
Computing MediumLevelActionManager
人类改变至策略:  place_onion_in_pot
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  deliver_soup
人类改变至策略:  random
人类改变至策略:  random
Ep 10 rewards: 240
Computing MediumLevelActionManager
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_in_pot
Ep 11 rewards: 280
Computing MediumLevelActionManager
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_in_pot
Ep 12 rewards: 300
Computing MediumLevelActionManager
人类改变至策略:  random
人类改变至策略:  deliver_soup
人类改变至策略:  deliver_soup
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  deliver_soup
Ep 13 rewards: 200
Computing MediumLevelActionManager
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_in_pot
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
Ep 14 rewards: 200
Computing MediumLevelActionManager
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_in_pot
人类改变至策略:  random
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
Ep 15 rewards: 260
Computing MediumLevelActionManager
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
人类改变至策略:  deliver_soup
Ep 16 rewards: 240
Computing MediumLevelActionManager
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  deliver_soup
人类改变至策略:  random
Ep 17 rewards: 240
Computing MediumLevelActionManager
人类改变至策略:  deliver_soup
人类改变至策略:  random
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_in_pot
人类改变至策略:  random
人类改变至策略:  place_onion_in_pot
Ep 18 rewards: 180
Computing MediumLevelActionManager
人类改变至策略:  deliver_soup
人类改变至策略:  random
人类改变至策略:  deliver_soup
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
Ep 19 rewards: 180
Computing MediumLevelActionManager
人类改变至策略:  place_onion_in_pot
人类改变至策略:  random
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  deliver_soup
人类改变至策略:  random
Ep 20 rewards: 260
Computing MediumLevelActionManager
人类改变至策略:  deliver_soup
人类改变至策略:  random
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_in_pot
Ep 21 rewards: 260
Computing MediumLevelActionManager
人类改变至策略:  random
人类改变至策略:  random
人类改变至策略:  place_onion_in_pot
人类改变至策略:  random
人类改变至策略:  random
人类改变至策略:  deliver_soup
Ep 22 rewards: 100
Computing MediumLevelActionManager
人类改变至策略:  place_onion_in_pot
人类改变至策略:  random
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  random
人类改变至策略:  random
Ep 23 rewards: 200
Computing MediumLevelActionManager
人类改变至策略:  place_onion_in_pot
人类改变至策略:  deliver_soup
人类改变至策略:  deliver_soup
人类改变至策略:  random
人类改变至策略:  deliver_soup
人类改变至策略:  deliver_soup
Ep 24 rewards: 140
Computing MediumLevelActionManager
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  deliver_soup
Ep 25 rewards: 260
Computing MediumLevelActionManager
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  place_onion_in_pot
人类改变至策略:  random
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  deliver_soup
人类改变至策略:  random
Ep 26 rewards: 120
Computing MediumLevelActionManager
人类改变至策略:  place_onion_and_deliver_soup
人类改变至策略:  deliver_soup
人类改变至策略:  place_onion_and_deliver_soup
Traceback (most recent call last):
  File "/alpha/overcooked_rl/algorithms/bpr_NN_scriptedPolicy.py", line 317, in <module>
    bpr_online.play(args, logger=None)
  File "/alpha/overcooked_rl/algorithms/bpr_NN_scriptedPolicy.py", line 145, in play
    best_agent_id, best_agent = self._reuse_optimal_policy()  # 选择belief最大的智能体
  File "/alpha/overcooked_rl/algorithms/bpr_NN_scriptedPolicy.py", line 247, in _reuse_optimal_policy
    target_task = max(self.belief, key=self.belief.get) # "metatask_1"
